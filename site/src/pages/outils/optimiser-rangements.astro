---
import '@/styles/global.css';
import BaseLayout from '@/layouts/BaseLayout.astro';
import Navbar from '@/components/Navbar.astro';
import Footer from '@/components/Footer.astro';
---

<BaseLayout 
  title="Optimiseur de Rangements - Maximisez vos Placards - Cristallina"
  description="Optimisez l'espace de vos placards et dressings. Calculateur gratuit pour maximiser vos rangements avec solutions pratiques."
  canonical="https://www.cristallina.fr/outils/optimiser-rangements/"
>
  <Navbar />
  
  <main class="pt-16">
    <!-- Hero Section -->
    <section class="section-soft py-20">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
        <div class="space-y-8">
          <div class="inline-block">
            <span class="inline-flex items-center px-6 py-3 bg-white/90 backdrop-blur-sm shadow-soft rounded-full border border-feminine">
              <span class="mr-3 text-lg">üì¶</span> 
              <span class="title-elegant text-sm">Optimiseur Gratuit</span>
            </span>
          </div>
          
          <h1 class="text-5xl md:text-7xl lg:text-8xl font-display leading-tight">
            <span class="block title-elegant">Optimise tes</span>
            <span class="block text-6xl md:text-8xl lg:text-9xl" style="color: #D4A574; font-style: italic;">rangements</span>
          </h1>
          
          <div class="quote-feminine max-w-3xl mx-auto">
            Maximise l'espace de tes placards, dressings et zones de rangement
          </div>
          
          <div class="flex flex-wrap justify-center gap-4 text-sm" style="color: #8B8B8B;">
            <span class="flex items-center gap-2">
              <span class="w-2 h-2 bg-green-400 rounded-full"></span>
              Gain d'espace
            </span>
            <span class="flex items-center gap-2">
              <span class="w-2 h-2 bg-blue-400 rounded-full"></span>
              Solutions pratiques
            </span>
            <span class="flex items-center gap-2">
              <span class="w-2 h-2 bg-purple-400 rounded-full"></span>
              Budget optimis√©
            </span>
          </div>
        </div>
      </div>
    </section>

    <!-- Calculator Interface -->
    <section class="py-20">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        
        <!-- Main Calculator -->
        <div class="grid lg:grid-cols-3 gap-8">
          
          <!-- Input Form -->
          <div class="lg:col-span-1">
            <div class="card-feminine shadow-soft-hover">
              <h2 class="text-2xl title-elegant mb-6">Analyse mon espace</h2>
              
              <!-- Storage Type -->
              <div class="mb-6">
                <label class="block text-sm font-semibold mb-3" style="color: #5D4E75;">Type de rangement</label>
                <div class="grid grid-cols-1 gap-2" id="storage-type">
                  <button class="storage-btn" data-type="placard-chambre">üëó Placard chambre</button>
                  <button class="storage-btn" data-type="dressing">üö™ Dressing</button>
                  <button class="storage-btn" data-type="placard-entree">üß• Placard entr√©e</button>
                  <button class="storage-btn" data-type="cuisine">üçΩÔ∏è Placards cuisine</button>
                  <button class="storage-btn" data-type="bureau">üìö Bureau/biblioth√®que</button>
                  <button class="storage-btn" data-type="salle-de-bain">üß¥ Salle de bain</button>
                </div>
              </div>

              <!-- Current Dimensions -->
              <div class="mb-6">
                <label class="block text-sm font-semibold mb-3" style="color: #5D4E75;">Dimensions actuelles</label>
                <div class="grid grid-cols-2 gap-3">
                  <div>
                    <label class="text-xs mb-1 block" style="color: #8B8B8B;">Largeur (cm)</label>
                    <input type="number" id="width" placeholder="120" step="1" class="w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20">
                  </div>
                  <div>
                    <label class="text-xs mb-1 block" style="color: #8B8B8B;">Profondeur (cm)</label>
                    <input type="number" id="depth" placeholder="60" step="1" class="w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20">
                  </div>
                </div>
                <div class="mt-3">
                  <label class="text-xs mb-1 block" style="color: #8B8B8B;">Hauteur (cm)</label>
                  <input type="number" id="height" placeholder="220" step="1" class="w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20">
                </div>
              </div>

              <!-- Current Issues -->
              <div class="mb-6">
                <label class="block text-sm font-semibold mb-3" style="color: #5D4E75;">Probl√®mes actuels</label>
                <div class="space-y-2" id="current-issues">
                  <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="issue-checkbox" value="space-wasted" class="rounded border-border">
                    <span>Espace perdu en hauteur</span>
                  </label>
                  <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="issue-checkbox" value="disorganized" class="rounded border-border">
                    <span>D√©sorganis√© / difficile √† ranger</span>
                  </label>
                  <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="issue-checkbox" value="hard-access" class="rounded border-border">
                    <span>Zones difficiles d'acc√®s</span>
                  </label>
                  <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="issue-checkbox" value="not-enough-space" class="rounded border-border">
                    <span>Pas assez d'espace</span>
                  </label>
                  <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="issue-checkbox" value="seasonal-items" class="rounded border-border">
                    <span>Objets saisonniers encombrants</span>
                  </label>
                </div>
              </div>

              <!-- Budget Range -->
              <div class="mb-6">
                <label class="block text-sm font-semibold mb-3" style="color: #5D4E75;">Budget disponible</label>
                <select id="budget-range" class="w-full px-3 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/20">
                  <option value="low">Moins de 50‚Ç¨ (solutions simples)</option>
                  <option value="medium" selected>50-150‚Ç¨ (am√©nagements modulaires)</option>
                  <option value="high">150-400‚Ç¨ (syst√®me complet)</option>
                  <option value="premium">400‚Ç¨+ (sur-mesure)</option>
                </select>
              </div>

              <!-- Calculate Button -->
              <button id="optimize-storage-btn" class="btn-feminine w-full shadow-soft-hover">
                üì¶ Optimiser mes rangements
              </button>
            </div>

            <!-- Quick Tips -->
            <div class="card-feminine shadow-soft-hover mt-6">
              <h3 class="text-lg title-elegant mb-4">üéØ Objectifs d'optimisation</h3>
              <div class="space-y-2 text-xs" style="color: #8B8B8B;">
                <div>‚Ä¢ Gagner 30-50% d'espace</div>
                <div>‚Ä¢ Am√©liorer l'accessibilit√©</div>
                <div>‚Ä¢ Organiser par fr√©quence d'usage</div>
                <div>‚Ä¢ Exploiter la hauteur</div>
              </div>
            </div>
          </div>

          <!-- Results & Solutions -->
          <div class="lg:col-span-2">
            <div class="card-feminine shadow-soft-hover">
              <h3 class="text-xl title-elegant mb-6">Mes solutions d'optimisation</h3>
              
              <!-- Results Display -->
              <div id="storage-results" class="hidden">
                
                <!-- Space Analysis -->
                <div class="bg-gradient-to-r from-primary/10 to-accent/10 rounded-xl p-6 mb-6">
                  <div class="grid md:grid-cols-3 gap-6">
                    <div class="text-center">
                      <div class="text-3xl font-display mb-2" style="color: #D4A574;" id="space-gained">
                        +40%
                      </div>
                      <div class="text-sm" style="color: #8B8B8B;">Espace gagn√©</div>
                    </div>
                    <div class="text-center">
                      <div class="text-3xl font-display mb-2" style="color: #8B7AA8;" id="efficiency-score">
                        85%
                      </div>
                      <div class="text-sm" style="color: #8B8B8B;">Efficacit√©</div>
                    </div>
                    <div class="text-center">
                      <div class="text-3xl font-display mb-2" style="color: #8B92A8;" id="solutions-count">
                        6 solutions
                      </div>
                      <div class="text-sm" style="color: #8B8B8B;">√Ä appliquer</div>
                    </div>
                  </div>
                </div>

                <!-- Priority Solutions -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                  
                  <!-- High Impact Solutions -->
                  <div class="bg-green-50 rounded-xl p-6">
                    <h4 class="font-semibold mb-3" style="color: #5D4E75;">üéØ Impact imm√©diat</h4>
                    <div id="high-impact-solutions" class="space-y-2 text-sm">
                      <!-- Dynamic content -->
                    </div>
                  </div>

                  <!-- Quick Wins -->
                  <div class="bg-blue-50 rounded-xl p-6">
                    <h4 class="font-semibold mb-3" style="color: #5D4E75;">‚ö° Solutions rapides</h4>
                    <div id="quick-win-solutions" class="space-y-2 text-sm">
                      <!-- Dynamic content -->
                    </div>
                  </div>
                </div>

                <!-- Detailed Recommendations -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                  
                  <!-- Products & Accessories -->
                  <div class="bg-purple-50 rounded-xl p-6">
                    <h4 class="font-semibold mb-3" style="color: #5D4E75;">üõí Produits recommand√©s</h4>
                    <div id="recommended-products" class="space-y-2 text-sm">
                      <!-- Dynamic content -->
                    </div>
                  </div>

                  <!-- Layout Optimization -->
                  <div class="bg-orange-50 rounded-xl p-6">
                    <h4 class="font-semibold mb-3" style="color: #5D4E75;">üìê R√©organisation</h4>
                    <div id="layout-optimization" class="space-y-2 text-sm">
                      <!-- Dynamic content -->
                    </div>
                  </div>
                </div>

                <!-- Budget & Implementation -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                  
                  <!-- Budget Breakdown -->
                  <div class="bg-yellow-50 rounded-xl p-6">
                    <h4 class="font-semibold mb-3" style="color: #5D4E75;">üí∞ R√©partition budget</h4>
                    <div id="budget-breakdown" class="space-y-2 text-sm">
                      <!-- Dynamic content -->
                    </div>
                  </div>

                  <!-- Implementation Steps -->
                  <div class="bg-pink-50 rounded-xl p-6">
                    <h4 class="font-semibold mb-3" style="color: #5D4E75;">üìã Plan d'action</h4>
                    <div id="implementation-steps" class="space-y-2 text-sm">
                      <!-- Dynamic content -->
                    </div>
                  </div>
                </div>

                <!-- Pro Tips -->
                <div class="bg-gray-50 rounded-xl p-6">
                  <h4 class="font-semibold mb-3" style="color: #5D4E75;">üí° Astuces d'organisation</h4>
                  <div id="organization-tips" class="space-y-2 text-sm">
                    <!-- Dynamic tips -->
                  </div>
                </div>
              </div>

              <!-- Initial State -->
              <div id="storage-initial-state" class="text-center py-12">
                <div class="text-6xl mb-4">üì¶</div>
                <p style="color: #8B8B8B;">S√©lectionnez votre type de rangement pour commencer l'analyse</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Storage Solutions Gallery -->
        <div class="mt-16">
          <h3 class="text-2xl title-elegant text-center mb-8">Solutions par type d'espace</h3>
          
          <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-6">
            <div class="card-feminine text-center">
              <div class="text-3xl mb-3">üëó</div>
              <h4 class="font-semibold mb-2" style="color: #5D4E75;">Dressing</h4>
              <div class="text-sm space-y-1" style="color: #8B8B8B;">
                <div>‚Ä¢ Barres modulables</div>
                <div>‚Ä¢ √âtag√®res ajustables</div>
                <div>‚Ä¢ Tiroirs transparents</div>
              </div>
            </div>

            <div class="card-feminine text-center">
              <div class="text-3xl mb-3">üçΩÔ∏è</div>
              <h4 class="font-semibold mb-2" style="color: #5D4E75;">Cuisine</h4>
              <div class="text-sm space-y-1" style="color: #8B8B8B;">
                <div>‚Ä¢ Plateaux tournants</div>
                <div>‚Ä¢ Paniers coulissants</div>
                <div>‚Ä¢ Organiseurs tiroirs</div>
              </div>
            </div>

            <div class="card-feminine text-center">
              <div class="text-3xl mb-3">üìö</div>
              <h4 class="font-semibold mb-2" style="color: #5D4E75;">Bureau</h4>
              <div class="text-sm space-y-1" style="color: #8B8B8B;">
                <div>‚Ä¢ Classeurs verticaux</div>
                <div>‚Ä¢ Bo√Ætes de tri</div>
                <div>‚Ä¢ Syst√®mes muraux</div>
              </div>
            </div>

            <div class="card-feminine text-center">
              <div class="text-3xl mb-3">üß¥</div>
              <h4 class="font-semibold mb-2" style="color: #5D4E75;">Salle de bain</h4>
              <div class="text-sm space-y-1" style="color: #8B8B8B;">
                <div>‚Ä¢ Organiseurs tiroirs</div>
                <div>‚Ä¢ √âtag√®res d'angle</div>
                <div>‚Ä¢ Suspensions portes</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="py-20 section-soft">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <h3 class="text-2xl title-elegant text-center mb-8">Questions fr√©quentes</h3>
        
        <div class="space-y-6">
          <div class="card-feminine">
            <h4 class="font-semibold mb-2" style="color: #5D4E75;">Comment optimiser un petit placard ?</h4>
            <p class="text-sm" style="color: #8B8B8B;">Utilisez la hauteur avec des √©tag√®res suppl√©mentaires, installez des organiseurs de porte, et adoptez le rangement vertical. Les bo√Ætes transparentes aident √† visualiser le contenu.</p>
          </div>

          <div class="card-feminine">
            <h4 class="font-semibold mb-2" style="color: #5D4E75;">Quelles sont les erreurs √† √©viter ?</h4>
            <p class="text-sm" style="color: #8B8B8B;">Ne pas exploiter la hauteur, ranger les objets lourds en haut, n√©gliger les angles morts, et ne pas trier r√©guli√®rement. √âvitez aussi les solutions trop complexes.</p>
          </div>

          <div class="card-feminine">
            <h4 class="font-semibold mb-2" style="color: #5D4E75;">Combien de temps pour r√©organiser un dressing ?</h4>
            <p class="text-sm" style="color: #8B8B8B;">Comptez un week-end complet : 1 jour pour vider/trier/nettoyer, 1 jour pour installer les nouvelles solutions et reretranger. Le tri est l'√©tape la plus longue mais cruciale.</p>
          </div>

          <div class="card-feminine">
            <h4 class="font-semibold mb-2" style="color: #5D4E75;">Quels produits pour d√©buter l'organisation ?</h4>
            <p class="text-sm" style="color: #8B8B8B;">Commencez par des bo√Ætes transparentes, organiseurs de tiroirs, barres extensibles et √©tag√®res ajustables. Ces basiques couvrent 80% des besoins pour moins de 100‚Ç¨.</p>
          </div>
        </div>
      </div>
    </section>
  </main>

  <Footer />
</BaseLayout>

<style>
.storage-btn {
  padding: 0.75rem;
  font-size: 0.875rem;
  text-align: left;
  border-radius: 0.75rem;
  border: 1px solid rgba(139, 122, 168, 0.15);
  background: rgba(255, 255, 255, 0.8);
  transition: all 0.3s ease;
  cursor: pointer;
}

.storage-btn:hover,
.storage-btn.active {
  background: linear-gradient(135deg, var(--color-primary-light), var(--color-accent-light));
  border-color: rgba(139, 122, 168, 0.3);
  box-shadow: 0 4px 24px rgba(139, 122, 168, 0.08);
  color: #5D4E75;
}

.issue-checkbox {
  accent-color: #8B7AA8;
}

@keyframes organize-animation {
  0%, 100% { 
    transform: translateY(0px);
  }
  50% { 
    transform: translateY(-5px);
  }
}

.organize-animation {
  animation: organize-animation 2s ease-in-out infinite;
}

.solution-item {
  padding: 0.5rem;
  margin-bottom: 0.5rem;
  border-radius: 0.5rem;
  background: rgba(255, 255, 255, 0.5);
  border-left: 3px solid #D4A574;
}

.priority-high {
  border-left-color: #10B981;
}

.priority-medium {
  border-left-color: #F59E0B;
}

.priority-low {
  border-left-color: #6B7280;
}
</style>

<script>
// Storage optimization configurations
const storageTypes = {
  'placard-chambre': {
    name: 'Placard chambre',
    commonIssues: ['space-wasted', 'disorganized', 'seasonal-items'],
    baseEfficiency: 60,
    solutions: {
      'space-wasted': [
        '√âtag√®res suppl√©mentaires ajustables',
        'Double barre de penderie',
        'Organiseurs de porte'
      ],
      'disorganized': [
        'Bo√Ætes de rangement transparentes',
        'S√©parateurs de tiroirs',
        'Syst√®me d\'√©tiquetage'
      ],
      'hard-access': [
        'Tiroirs coulissants',
        'Paniers transparents',
        '√âclairage LED int√©gr√©'
      ],
      'not-enough-space': [
        'Rangement sous vide',
        'Organiseurs verticaux',
        'Crochets muraux suppl√©mentaires'
      ],
      'seasonal-items': [
        'Bacs de stockage haute √©tag√®re',
        'Housses sous vide',
        'Rotation saisonni√®re organis√©e'
      ]
    }
  },
  'dressing': {
    name: 'Dressing',
    commonIssues: ['space-wasted', 'hard-access', 'disorganized'],
    baseEfficiency: 70,
    solutions: {
      'space-wasted': [
        'Syst√®me modulaire sur mesure',
        'Barres extensibles multi-niveaux',
        '√âtag√®res d\'angles optimis√©es'
      ],
      'disorganized': [
        'Compartiments sp√©cialis√©s',
        'Tiroirs avec s√©parateurs',
        'Syst√®me de codage couleur'
      ],
      'hard-access': [
        'Tiroirs coulissants transparents',
        'Barres descendantes motoris√©es',
        'Miroirs int√©gr√©s avec √©clairage'
      ]
    }
  },
  'placard-entree': {
    name: 'Placard entr√©e',
    commonIssues: ['disorganized', 'hard-access', 'seasonal-items'],
    baseEfficiency: 55,
    solutions: {
      'disorganized': [
        'Crochets par personne/saison',
        '√âtag√®re chaussures modulaire',
        'Panier accessoires (gants, etc.)'
      ],
      'seasonal-items': [
        'Rotation manteaux √©t√©/hiver',
        'Bacs √©tiquet√©s par saison',
        'Stockage vertical optimis√©'
      ]
    }
  },
  'cuisine': {
    name: 'Placards cuisine',
    commonIssues: ['hard-access', 'disorganized', 'not-enough-space'],
    baseEfficiency: 65,
    solutions: {
      'hard-access': [
        'Plateaux tournants angles',
        'Tiroirs coulissants profonds',
        'Paniers extractibles'
      ],
      'disorganized': [
        'Organiseurs tiroirs ustensiles',
        'Porte-√©pices muraux',
        'Syst√®me de rangement vertical'
      ]
    }
  },
  'bureau': {
    name: 'Bureau/biblioth√®que',
    commonIssues: ['disorganized', 'space-wasted', 'hard-access'],
    baseEfficiency: 50,
    solutions: {
      'disorganized': [
        'Classeurs et trieur documents',
        'Bo√Ætes de tri par projet',
        'Syst√®me d\'archivage num√©rique'
      ],
      'space-wasted': [
        '√âtag√®res murales suppl√©mentaires',
        'Organiseurs bureau verticaux',
        'Meubles de rangement multifonctions'
      ]
    }
  },
  'salle-de-bain': {
    name: 'Salle de bain',
    commonIssues: ['space-wasted', 'disorganized', 'hard-access'],
    baseEfficiency: 45,
    solutions: {
      'space-wasted': [
        '√âtag√®res d\'angle murales',
        'Organiseurs de porte',
        'Rangement au-dessus WC'
      ],
      'disorganized': [
        'Organiseurs tiroirs cosm√©tiques',
        'Paniers par cat√©gorie',
        'Distributeurs muraux'
      ]
    }
  }
};

// Budget-based product recommendations
const budgetSolutions = {
  low: {
    name: 'Solutions √©conomiques',
    products: [
      { item: 'Bo√Ætes transparentes empilables', price: '15-25‚Ç¨', impact: 'Moyen' },
      { item: 'Crochets adhesifs suppl√©mentaires', price: '5-10‚Ç¨', impact: 'Faible' },
      { item: 'Organiseurs tiroirs basiques', price: '10-20‚Ç¨', impact: 'Moyen' },
      { item: '√âtag√®res ajustables IKEA', price: '15-30‚Ç¨', impact: '√âlev√©' }
    ]
  },
  medium: {
    name: 'Solutions modulaires',
    products: [
      { item: 'Syst√®me √©tag√®res modulaires', price: '40-80‚Ç¨', impact: '√âlev√©' },
      { item: 'Organiseurs tiroirs premium', price: '25-45‚Ç¨', impact: '√âlev√©' },
      { item: 'Barres extensibles ajustables', price: '20-35‚Ç¨', impact: '√âlev√©' },
      { item: 'Paniers coulissants', price: '30-60‚Ç¨', impact: '√âlev√©' }
    ]
  },
  high: {
    name: 'Syst√®mes complets',
    products: [
      { item: 'Kit dressing modulaire complet', price: '150-300‚Ç¨', impact: 'Tr√®s √©lev√©' },
      { item: 'Tiroirs coulissants sur mesure', price: '80-150‚Ç¨', impact: 'Tr√®s √©lev√©' },
      { item: '√âclairage LED int√©gr√©', price: '40-80‚Ç¨', impact: 'Moyen' },
      { item: 'Miroirs avec rangements', price: '60-120‚Ç¨', impact: 'Moyen' }
    ]
  },
  premium: {
    name: 'Sur-mesure premium',
    products: [
      { item: 'Am√©nagement sur-mesure complet', price: '400-800‚Ç¨', impact: 'Maximum' },
      { item: 'Syst√®mes motoris√©s', price: '200-400‚Ç¨', impact: '√âlev√©' },
      { item: 'Finitions haut de gamme', price: '100-200‚Ç¨', impact: 'Moyen' },
      { item: 'Domotique int√©gr√©e', price: '150-300‚Ç¨', impact: 'Faible' }
    ]
  }
};

let selectedStorageType = null;
let currentIssues = [];
let dimensions = { width: 0, height: 0, depth: 0 };

document.addEventListener('DOMContentLoaded', () => {
  setupEventListeners();
});

function setupEventListeners() {
  // Storage type selection
  document.querySelectorAll('.storage-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.storage-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      selectedStorageType = btn.dataset.type;
      resetResults();
    });
  });

  // Issue checkboxes
  document.querySelectorAll('.issue-checkbox').forEach(checkbox => {
    checkbox.addEventListener('change', updateIssues);
  });

  // Dimensions inputs
  document.getElementById('width').addEventListener('input', updateDimensions);
  document.getElementById('height').addEventListener('input', updateDimensions);
  document.getElementById('depth').addEventListener('input', updateDimensions);

  // Calculate button
  document.getElementById('optimize-storage-btn').addEventListener('click', optimizeStorage);
}

function updateIssues() {
  currentIssues = Array.from(document.querySelectorAll('.issue-checkbox:checked'))
    .map(cb => cb.value);
}

function updateDimensions() {
  dimensions.width = parseFloat(document.getElementById('width').value) || 0;
  dimensions.height = parseFloat(document.getElementById('height').value) || 0;
  dimensions.depth = parseFloat(document.getElementById('depth').value) || 0;
}

function optimizeStorage() {
  if (!selectedStorageType || dimensions.width === 0 || dimensions.height === 0) {
    alert('Merci de s√©lectionner un type de rangement et renseigner les dimensions !');
    return;
  }

  const budget = document.getElementById('budget-range').value;
  const optimization = calculateOptimization(selectedStorageType, currentIssues, dimensions, budget);
  
  displayOptimizationResults(optimization);
}

function calculateOptimization(storageType, issues, dims, budget) {
  const typeConfig = storageTypes[storageType];
  const budgetConfig = budgetSolutions[budget];
  
  // Calculate current volume and potential
  const currentVolume = dims.width * dims.height * dims.depth;
  const optimizedVolume = currentVolume * 1.4; // Base 40% improvement
  
  // Calculate efficiency score based on issues addressed
  let efficiencyGain = 0;
  issues.forEach(issue => {
    if (typeConfig.commonIssues.includes(issue)) {
      efficiencyGain += 15; // 15% per major issue addressed
    } else {
      efficiencyGain += 10; // 10% per other issue
    }
  });
  
  const totalEfficiency = Math.min(95, typeConfig.baseEfficiency + efficiencyGain);
  const spaceGain = Math.round((optimizedVolume - currentVolume) / currentVolume * 100);
  
  // Generate solutions based on issues
  const solutions = {
    highImpact: [],
    quickWins: [],
    products: budgetConfig.products,
    layoutChanges: []
  };
  
  // High impact solutions
  issues.forEach(issue => {
    if (typeConfig.solutions[issue]) {
      typeConfig.solutions[issue].slice(0, 2).forEach(solution => {
        solutions.highImpact.push(solution);
      });
    }
  });
  
  // Quick wins (always applicable)
  solutions.quickWins = [
    'Tri et d√©sencombrement imm√©diat',
    'Regroupement par fr√©quence d\'usage',
    'Exploitation optimale de la hauteur',
    'Organisation visuelle avec √©tiquettes'
  ];
  
  // Layout optimizations based on storage type
  if (storageType === 'dressing' || storageType === 'placard-chambre') {
    solutions.layoutChanges = [
      `Zone haute (${Math.round(dims.height * 0.7)}cm+): objets saisonniers`,
      `Zone m√©diane (${Math.round(dims.height * 0.3)}-${Math.round(dims.height * 0.7)}cm): usage quotidien`,
      'Zone basse: chaussures et objets lourds',
      'Profondeur optimale: 60cm max pour l\'accessibilit√©'
    ];
  } else if (storageType === 'cuisine') {
    solutions.layoutChanges = [
      'Objets fr√©quents √† hauteur des yeux',
      'Ustensiles lourds dans tiroirs bas',
      '√âpices et conserves visibles',
      'Zone de pr√©paration d√©gag√©e'
    ];
  }
  
  // Implementation steps
  const steps = [
    'Vider compl√®tement l\'espace',
    'Nettoyer et mesurer pr√©cis√©ment',
    'Trier : garder / donner / jeter',
    'Installer les nouvelles solutions',
    'Ranger par zones logiques',
    '√âtiqueter et maintenir l\'organisation'
  ];
  
  return {
    spaceGain,
    efficiency: totalEfficiency,
    solutionsCount: solutions.highImpact.length + solutions.quickWins.length,
    solutions,
    steps,
    budget: budgetConfig,
    storageType: typeConfig
  };
}

function displayOptimizationResults(optimization) {
  // Show results section
  document.getElementById('storage-initial-state').classList.add('hidden');
  document.getElementById('storage-results').classList.remove('hidden');
  
  // Update main metrics
  document.getElementById('space-gained').textContent = `+${optimization.spaceGain}%`;
  document.getElementById('efficiency-score').textContent = `${optimization.efficiency}%`;
  document.getElementById('solutions-count').textContent = `${optimization.solutionsCount} solutions`;
  
  // High impact solutions
  const highImpactContainer = document.getElementById('high-impact-solutions');
  highImpactContainer.innerHTML = optimization.solutions.highImpact.slice(0, 5).map(solution => `
    <div class="solution-item priority-high">
      <div class="flex items-start gap-2">
        <span class="text-green-600 mt-0.5">üéØ</span>
        <span>${solution}</span>
      </div>
    </div>
  `).join('');
  
  // Quick wins
  const quickWinsContainer = document.getElementById('quick-win-solutions');
  quickWinsContainer.innerHTML = optimization.solutions.quickWins.map(solution => `
    <div class="solution-item priority-medium">
      <div class="flex items-start gap-2">
        <span class="text-blue-600 mt-0.5">‚ö°</span>
        <span>${solution}</span>
      </div>
    </div>
  `).join('');
  
  // Recommended products
  const productsContainer = document.getElementById('recommended-products');
  productsContainer.innerHTML = optimization.budget.products.map(product => `
    <div class="solution-item">
      <div class="flex justify-between items-start">
        <div class="flex-1">
          <div class="font-medium">${product.item}</div>
          <div class="text-xs text-purple-600">Impact: ${product.impact}</div>
        </div>
        <div class="text-sm font-semibold" style="color: #D4A574;">${product.price}</div>
      </div>
    </div>
  `).join('');
  
  // Layout optimization
  const layoutContainer = document.getElementById('layout-optimization');
  layoutContainer.innerHTML = optimization.solutions.layoutChanges.map(change => `
    <div class="solution-item">
      <div class="flex items-start gap-2">
        <span class="text-orange-600 mt-0.5">üìê</span>
        <span>${change}</span>
      </div>
    </div>
  `).join('');
  
  // Budget breakdown
  const budgetContainer = document.getElementById('budget-breakdown');
  const totalBudgetMin = optimization.budget.products.reduce((sum, p) => sum + parseInt(p.price.split('-')[0]), 0);
  const totalBudgetMax = optimization.budget.products.reduce((sum, p) => sum + parseInt(p.price.split('-')[1] || p.price.split('-')[0]), 0);
  
  budgetContainer.innerHTML = `
    <div class="flex justify-between">
      <span>${optimization.budget.name}</span>
      <span class="font-semibold">${totalBudgetMin}-${totalBudgetMax}‚Ç¨</span>
    </div>
    <div class="flex justify-between text-xs" style="color: #8B8B8B;">
      <span>ROI estim√©</span>
      <span>6-12 mois</span>
    </div>
    <div class="text-xs pt-2" style="color: #8B8B8B;">
      Gain de temps quotidien: 10-15 min
    </div>
  `;
  
  // Implementation steps
  const stepsContainer = document.getElementById('implementation-steps');
  stepsContainer.innerHTML = optimization.steps.map((step, index) => `
    <div class="flex items-start gap-2">
      <span class="font-semibold text-pink-600">${index + 1}.</span>
      <span>${step}</span>
    </div>
  `).join('');
  
  // Organization tips
  const tipsContainer = document.getElementById('organization-tips');
  const tips = [
    `Sp√©cifique ${optimization.storageType.name}: exploitez chaque cm¬≥`,
    'R√®gle des 80/20: 80% usage quotidien accessible facilement',
    'Maintenance hebdomadaire: 15 min pour maintenir l\'ordre',
    'Seasonal review: r√©organiser 2x par an selon les saisons',
    'Photo avant/apr√®s pour motivation et suivi',
    'Impliquer toute la famille dans le syst√®me'
  ];
  
  if (optimization.spaceGain > 50) {
    tips.unshift('Excellent potentiel d\'optimisation d√©tect√© !');
  }
  
  tipsContainer.innerHTML = tips.map(tip => `
    <div class="flex items-start gap-2">
      <span class="text-gray-600 mt-0.5">üí°</span>
      <span>${tip}</span>
    </div>
  `).join('');
  
  // Smooth scroll to results
  document.getElementById('storage-results').scrollIntoView({ 
    behavior: 'smooth', 
    block: 'start' 
  });
}

function resetResults() {
  document.getElementById('storage-initial-state').classList.remove('hidden');
  document.getElementById('storage-results').classList.add('hidden');
}
</script>